<?xml version="1.0" encoding="UTF-8" ?>
<!--
  ~ /*
  ~  *****************************************************************************
  ~  * Copyright ( c ) 2016 Heren Tianjin Inc. All Rights Reserved.
  ~  *
  ~  * This software is the confidential and proprietary information of Heren Tianjin Inc
  ~  * ("Confidential Information").  You shall not disclose such Confidential Information
  ~  *  and shall use it only in accordance with the terms of the license agreement
  ~  *  you entered into with Heren Tianjin or a Heren Tianjin authorized
  ~  *  reseller (the "License Agreement").
  ~  ****************************************************************************
  ~  */
  -->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.heren.turtle.server.dao.turtleDao.TurtleSignDao">

    <resultMap id="signMapper" type="java.util.Map">
        <result column="id" property="id"/>
        <result column="series" property="series"/>
        <result column="patient_id" property="patientId"/>
        <result column="DEPT_CODE" property="deptCode"/>
        <result column="PLAN_TIME" property="planTime"/>
        <result column="RECORD_TIME" property="recordTime"/>
        <result column="VITALSIGN_NAME" property="vitalsignName"/>
        <result column="UPDATE_TIME" property="updateTime"/>
        <result column="ACTION_TYPE" property="actionType"/>
        <result column="VITALSIGN_DETAILS_TYPE" property="vitalsignDetailsType"/>
        <result column="VITALSIGN_DETAILS" property="vitalsignDetails" jdbcType="CLOB" javaType="java.lang.String"
                typeHandler="com.heren.turtle.server.core.OracleClobTypeHandler"/>
    </resultMap>

    <insert id="add" parameterType="java.util.Map">
        <selectKey resultType="java.lang.Long" keyProperty="id" order="BEFORE">
            select sign_auto_id.NEXTVAL FROM dual
        </selectKey>
        insert into MNIS_VITALSIGN
        <trim prefix="(" suffix=")" suffixOverrides=",">
            id,
            <if test="series!=null">
                series,
            </if>
            <if test="patientId!=null">
                patient_id,
            </if>
            <if test="deptCode!=null">
                DEPT_CODE,
            </if>
            <if test="planTime!=null">
                PLAN_TIME,
            </if>
            <if test="recordTime!=null">
                RECORD_TIME,
            </if>
            <if test="vitalSignName!=null">
                VITALSIGN_NAME,
            </if>
            <if test="updateTime!=null">
                UPDATE_TIME,
            </if>
            <if test="actionType!=null">
                ACTION_TYPE,
            </if>
            <if test="vitalSignDetails!=null">
                VITALSIGN_DETAILS,
            </if>
            <if test="vitalSignDetailsType!=null">
                VITALSIGN_DETAILS_TYPE,
            </if>
        </trim>
        VALUES
        <trim prefix="(" suffix=")" suffixOverrides=",">
            #{id,jdbcType=NUMERIC},
            <if test="series!=null">
                #{series,jdbcType=VARCHAR},
            </if>
            <if test="patientId!=null">
                #{patientId,jdbcType=VARCHAR},
            </if>
            <if test="deptCode!=null">
                #{deptCode,jdbcType=VARCHAR},
            </if>
            <if test="planTime!=null">
                to_date(#{planTime,jdbcType=VARCHAR},'yyyy-MM-dd hh24:mi:ss'),
            </if>
            <if test="recordTime!=null">
                to_date(#{recordTime,jdbcType=VARCHAR},'yyyy-MM-dd hh24:mi:ss'),
            </if>
            <if test="vitalSignName!=null">
                #{vitalSignName,jdbcType=VARCHAR},
            </if>
            <if test="updateTime!=null">
                to_date(#{updateTime,jdbcType=VARCHAR},'yyyy-MM-dd hh24:mi:ss'),
            </if>
            <if test="actionType!=null">
                #{actionType,jdbcType=VARCHAR},
            </if>
            <if test="vitalSignDetails!=null">
                #{vitalSignDetails,jdbcType=CLOB},
            </if>
            <if test="vitalSignDetailsType!=null">
                #{vitalSignDetailsType,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>

    <update id="modify" parameterType="java.util.Map">
        update MNIS_VITALSIGN
        <set>
            <if test="deptCode!=null">
                DEPT_CODE=#{deptCode,jdbcType=VARCHAR},
            </if>
            <if test="planTime!=null">
                PLAN_TIME=to_date(#{planTime,jdbcType=VARCHAR},'yyyy-MM-dd hh24:mi:ss'),
            </if>
            <if test="recordTime!=null">
                RECORD_TIME=to_date(#{recordTime,jdbcType=VARCHAR},'yyyy-MM-dd hh24:mi:ss'),
            </if>
            <if test="vitalSignName!=null">
                VITALSIGN_NAME=#{vitalSignName,jdbcType=VARCHAR},
            </if>
            <if test="updateTime!=null">
                UPDATE_TIME=to_date(#{updateTime,jdbcType=VARCHAR},'yyyy-MM-dd hh24:mi:ss'),
            </if>
            <if test="actionType!=null">
                ACTION_TYPE=#{actionType,jdbcType=VARCHAR},
            </if>
            <if test="vitalSignDetails!=null">
                VITALSIGN_DETAILS=#{vitalSignDetails,jdbcType=CLOB},
            </if>
            <if test="vitalSignDetailsType!=null">
                VITALSIGN_DETAILS_TYPE=#{vitalSignDetailsType,jdbcType=VARCHAR},
            </if>
        </set>
        <where>
            <if test="series!=null">
                and series=#{series,jdbcType=VARCHAR}
            </if>
            <if test="patientId!=null">
                and patient_id=#{patientId,jdbcType=VARCHAR}
            </if>
            <if test="updateTime!=null">
                and UPDATE_TIME=to_date(#{updateTime,jdbcType=VARCHAR},'yyyy-MM-dd hh24:mi:ss')
            </if>
        </where>
    </update>

</mapper>